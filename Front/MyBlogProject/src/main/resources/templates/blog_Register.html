<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" th:href="@{/css/reset.css}">
	<link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
	<header class="site-header">
		<div class="container">
			<p class="brand">
			  <a th:href="@{/about}" style="text-decoration:none; color:inherit;">
			    <span class="logo"><span th:text="${userName}"></span>'s</span><span class="brand-text">Blog</span>
			  </a>
			</p>

			<nav id="site-nav" class="nav">
				<ul>
					<li><a th:href="@{/blog/welcome}">Home</a></li>
					<li><a th:href="@{/blog/register}" class="active">Blog Register</a></li>
					<li>
						<form th:action="@{/logout}" method="post">
							<button type="submit" class="logout-btn">Logout</button>
						</form>
					</li>
				</ul>
			</nav>
		</div>
	</header>


	<main class="container">
		<section class="editor" style="margin:22px 0 38px;">
			<h2 style="margin:0 0 8px; font-size:20px; font-weight:800; color:#0f172a;">
				記事ステータス管理
			</h2>
			<p class="hint" style="margin:0 0 14px; font-size:12px; color:#64748b;">
				下の表から、記事ごとにステータスを変更できます。
			</p>

			<div class="table-wrap">
				<table class="table">
					<thead>
						<tr>
							<th style="width:18%;">タイトル</th>
							<th style="width:18%;">カテゴリ</th>
							<th style="width:18%;">作成日時</th>
							<th style="width:18%;">ステータス</th>
							<th style="width:18%;">操作</th>
							<th style="width:10%;">削除</th>
						</tr>
					</thead>

					<tr th:each="blog : ${posts}">
						<td>
							<a th:href="@{'/blog/' + ${blog.blogId}}" th:text="${blog.blogTitle}"></a>
						</td>
						<td th:text="${blog.categoryName}"></td>
						<td th:text="${#dates.format(blog.createdAt, 'yyyy/MM/dd HH:mm')}"></td>
						<td>
							<form th:action="@{/blog/status/update}" method="post" class="inline-form">
								<input type="hidden" name="blogId" th:value="${blog.blogId}">
								<select name="visibility">
								  <option value="1" th:selected="${blog.visibility == 1}">公開</option>
								  <option value="3" th:selected="${blog.visibility == 3}">公開(コメント不可)</option>
								  <option value="2" th:selected="${blog.visibility == 2}">非公開</option>
								</select>
						<td>
							<button type="submit" class="btn ghost sm">保存</button>
							<a th:href="@{'/blog/edit/' + ${blog.blogId}}" class="btn ghost sm">編集</a>
						</td>
						</form>
						<td>
							<form th:action="@{/blog/delete}" method="post" class="inline-form"
								onsubmit="return confirm('本当に削除しますか？');">
								<input type="hidden" name="blogId" th:value="${blog.blogId}">

								<button type="submit" class="btn ghost sm">削除</button>

							</form>
						</td>
						</td>
					</tr>

				</table>
			</div>

			<div class="notice ok" th:if="${ok}" th:text="${ok}"></div>
			<div class="notice ng" th:if="${err}" th:text="${err}"></div>
		</section>
	</main>

	<footer class="site-footer">
		<small>Copyright &copy; SMH All rights reserved</small>
	</footer>
</body>

</html>